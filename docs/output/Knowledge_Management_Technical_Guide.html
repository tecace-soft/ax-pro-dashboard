
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge_Management_Technical_Guide</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1, h2, h3, h4, h5, h6 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        h1 { border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        h2 { border-bottom: 1px solid #bdc3c7; padding-bottom: 5px; }
        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        li {
            margin-bottom: 5px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .toc {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        .toc h2 {
            margin-top: 0;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin-bottom: 5px;
        }
        .toc a {
            text-decoration: none;
            color: #3498db;
        }
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>Knowledge Management Technical Guide</h1>
    <p><h1>Knowledge Management - Technical Documentation</h1></p><p><h2>Table of Contents</h2><br><li>[System Architecture](#system-architecture)</li><br><li>[API Reference](#api-reference)</li><br><li>[Database Schema](#database-schema)</li><br><li>[Configuration](#configuration)</li><br><li>[Deployment](#deployment)</li><br><li>[Monitoring](#monitoring)</li><br><li>[Security](#security)</li><br><li>[Troubleshooting](#troubleshooting)</li></p><p>---</p><p><h2>System Architecture</h2></p><p><h3>Overview</h3><br>The Knowledge Management system is built on a modern React-based frontend with a Node.js/Express backend, integrated with Azure services for document storage and search capabilities.</p><p><h3>Components</h3></p><p><h4>Frontend (React + TypeScript)</h4><br><li><strong>Dashboard</strong>: Main application interface</li><br><li><strong>Knowledge Management</strong>: Document management interface</li><br><li><strong>Search Engine</strong>: Multi-source search functionality</li><br><li><strong>File Upload</strong>: Drag-and-drop file upload system</li></p><p><h4>Backend Services</h4><br><li><strong>RAG API</strong>: Document processing and indexing</li><br><li><strong>Blob Storage</strong>: Azure Blob Storage for file management</li><br><li><strong>Search Index</strong>: Azure Cognitive Search for content search</li><br><li><strong>Authentication</strong>: Token-based authentication system</li></p><p><h4>External Integrations</h4><br><li><strong>Azure Blob Storage</strong>: File storage and management</li><br><li><strong>Azure Cognitive Search</strong>: Full-text search capabilities</li><br><li><strong>Supabase</strong>: Database and real-time features</li></p><p>---</p><p><h2>API Reference</h2></p><p><h3>RAG Management API</h3></p><p><h4>Base URL</h4><br><code>`</code><br>/rag-api<br><code>`</code></p><p><h4>Authentication</h4><br>All API requests require authentication via Bearer token:<br><code>`</code>http<br>Authorization: Bearer <token><br><code>`</code></p><p><h4>Endpoints</h4></p><p><h5>List Documents</h5><br><code>`</code>http<br>POST /rag-api<br>Content-Type: application/json</p><p>{<br>  "op": "list_docs",<br>  "top": 50,<br>  "skip": 0,<br>  "select": "chunk_id,parent_id,title,filepath,content"<br>}<br><code>`</code></p><p><strong>Response:</strong><br><code>`</code>json<br>{<br>  "ok": true,<br>  "result": {<br>    "index": {<br>      "value": [<br>        {<br>          "chunk_id": "doc1_chunk1",<br>          "parent_id": "document1.pdf",<br>          "title": "Document Title",<br>          "filepath": "/documents/document1.pdf",<br>          "content": "Document content..."<br>        }<br>      ]<br>    }<br>  }<br>}<br><code>`</code></p><p><h5>Search Documents</h5><br><code>`</code>http<br>POST /rag-api<br>Content-Type: application/json</p><p>{<br>  "op": "search",<br>  "q": "search query",<br>  "top": 20,<br>  "filter": "parent_id eq 'document1.pdf'",<br>  "select": "chunk_id,parent_id,title,filepath,content"<br>}<br><code>`</code></p><p><h5>Upload File</h5><br><code>`</code>http<br>POST /rag-api<br>Content-Type: multipart/form-data</p><p>{<br>  "op": "blob_upload",<br>  "file": <file_data>,<br>  "name": "document.pdf"<br>}<br><code>`</code></p><p><h5>Delete File</h5><br><code>`</code>http<br>POST /rag-api<br>Content-Type: application/json</p><p>{<br>  "op": "blob_delete",<br>  "name": "document.pdf"<br>}<br><code>`</code></p><p><h5>Reindex File</h5><br><code>`</code>http<br>POST /rag-api<br>Content-Type: application/json</p><p>{<br>  "op": "reindex",<br>  "name": "document.pdf"<br>}<br><code>`</code></p><p><h5>Clear Index</h5><br><code>`</code>http<br>POST /rag-api<br>Content-Type: application/json</p><p>{<br>  "op": "clear_by_parent",<br>  "name": "document.pdf"<br>}<br><code>`</code></p><p><h3>Error Handling</h3></p><p><h4>Common Error Codes</h4><br><li><strong>400</strong>: Bad Request - Invalid parameters</li><br><li><strong>401</strong>: Unauthorized - Invalid or missing token</li><br><li><strong>403</strong>: Forbidden - Insufficient permissions</li><br><li><strong>404</strong>: Not Found - Resource not found</li><br><li><strong>424</strong>: Failed Dependency - Backend service unavailable</li><br><li><strong>500</strong>: Internal Server Error - Server-side error</li></p><p><h4>Error Response Format</h4><br><code>`</code>json<br>{<br>  "ok": false,<br>  "error": "Error message",<br>  "code": 400,<br>  "details": "Additional error details"<br>}<br><code>`</code></p><p>---</p><p><h2>Database Schema</h2></p><p><h3>Supabase Tables</h3></p><p><h4>user_feedback</h4><br><code>`</code>sql<br>CREATE TABLE user_feedback (<br>  id SERIAL PRIMARY KEY,<br>  request_id VARCHAR(255) NOT NULL,<br>  timestamp TIMESTAMP NOT NULL,<br>  user_name VARCHAR(255) NOT NULL,<br>  user_id VARCHAR(255) NOT NULL,<br>  conversation_id VARCHAR(255) NOT NULL,<br>  reaction VARCHAR(50) NOT NULL,<br>  feedback_text TEXT,<br>  raw_data JSONB,<br>  created_at TIMESTAMP DEFAULT NOW(),<br>  chat_message TEXT,<br>  chat_response TEXT<br>);<br><code>`</code></p><p><h4>admin_feedback</h4><br><code>`</code>sql<br>CREATE TABLE admin_feedback (<br>  id SERIAL PRIMARY KEY,<br>  request_id VARCHAR(255) UNIQUE NOT NULL,<br>  feedback_verdict VARCHAR(10) NOT NULL CHECK (feedback_verdict IN ('good', 'bad')),<br>  feedback_text TEXT NOT NULL,<br>  corrected_response TEXT,<br>  prompt_apply BOOLEAN DEFAULT FALSE,<br>  created_at TIMESTAMP DEFAULT NOW(),<br>  updated_at TIMESTAMP DEFAULT NOW()<br>);<br><code>`</code></p><p><h3>Azure Search Index Schema</h3></p><p><h4>Document Index</h4><br><code>`</code>json<br>{<br>  "name": "documents",<br>  "fields": [<br>    {<br>      "name": "chunk_id",<br>      "type": "Edm.String",<br>      "key": true,<br>      "searchable": true,<br>      "filterable": true<br>    },<br>    {<br>      "name": "parent_id",<br>      "type": "Edm.String",<br>      "searchable": false,<br>      "filterable": true,<br>      "sortable": true<br>    },<br>    {<br>      "name": "title",<br>      "type": "Edm.String",<br>      "searchable": true,<br>      "filterable": false,<br>      "sortable": true<br>    },<br>    {<br>      "name": "filepath",<br>      "type": "Edm.String",<br>      "searchable": false,<br>      "filterable": true,<br>      "sortable": true<br>    },<br>    {<br>      "name": "content",<br>      "type": "Edm.String",<br>      "searchable": true,<br>      "filterable": false,<br>      "sortable": false<br>    }<br>  ]<br>}<br><code>`</code></p><p>---</p><p><h2>Configuration</h2></p><p><h3>Environment Variables</h3></p><p><h4>Frontend (.env)</h4><br><code>`</code>bash<br>VITE_API_BASE_URL=https://your-api-domain.com<br>VITE_SUPABASE_URL=https://your-project.supabase.co<br>VITE_SUPABASE_ANON_KEY=your-supabase-anon-key<br><code>`</code></p><p><h4>Backend (.env)</h4><br><code>`</code>bash<br>AZURE_STORAGE_CONNECTION_STRING=your-azure-storage-connection-string<br>AZURE_SEARCH_ENDPOINT=https://your-search-service.search.windows.net<br>AZURE_SEARCH_KEY=your-search-service-key<br>AZURE_SEARCH_INDEX_NAME=documents<br>SUPABASE_URL=https://your-project.supabase.co<br>SUPABASE_SERVICE_KEY=your-supabase-service-key<br><code>`</code></p><p><h3>Azure Configuration</h3></p><p><h4>Blob Storage</h4><br><li><strong>Container</strong>: <code>hr-ax-pro</code></li><br><li><strong>Access Level</strong>: Private</li><br><li><strong>CORS</strong>: Enabled for web applications</li></p><p><h4>Cognitive Search</h4><br><li><strong>Service Tier</strong>: Standard</li><br><li><strong>Replicas</strong>: 1</li><br><li><strong>Partitions</strong>: 1</li><br><li><strong>Indexing</strong>: Automatic</li></p><p>---</p><p><h2>Deployment</h2></p><p><h3>Prerequisites</h3><br><li>Node.js 18+</li><br><li>npm or yarn</li><br><li>Azure account with Blob Storage and Cognitive Search</li><br><li>Supabase account</li></p><p><h3>Frontend Deployment</h3><br><code>`</code>bash<br><h1>Install dependencies</h1><br>npm install</p><p><h1>Build for production</h1><br>npm run build</p><p><h1>Deploy to your hosting service</h1><br><h1>(e.g., Vercel, Netlify, Azure Static Web Apps)</h1><br><code>`</code></p><p><h3>Backend Deployment</h3><br><code>`</code>bash<br><h1>Install dependencies</h1><br>npm install</p><p><h1>Set environment variables</h1><br>cp .env.example .env<br><h1>Edit .env with your configuration</h1></p><p><h1>Start the server</h1><br>npm start<br><code>`</code></p><p><h3>Docker Deployment</h3><br><code>`</code>dockerfile<br><h1>Frontend Dockerfile</h1><br>FROM node:18-alpine<br>WORKDIR /app<br>COPY package*.json ./<br>RUN npm ci --only=production<br>COPY . .<br>RUN npm run build<br>EXPOSE 3000<br>CMD ["npm", "start"]<br><code>`</code></p><p>---</p><p><h2>Monitoring</h2></p><p><h3>Key Metrics</h3><br><li><strong>Upload Success Rate</strong>: Percentage of successful file uploads</li><br><li><strong>Index Sync Rate</strong>: Percentage of files properly synced</li><br><li><strong>Search Response Time</strong>: Average search query response time</li><br><li><strong>Error Rate</strong>: Percentage of failed API requests</li></p><p><h3>Logging</h3><br><li><strong>Frontend</strong>: Console logs for debugging</li><br><li><strong>Backend</strong>: Structured logging with Winston</li><br><li><strong>Azure</strong>: Application Insights integration</li></p><p><h3>Health Checks</h3><br><code>`</code>http<br>GET /health<br><code>`</code></p><p><strong>Response:</strong><br><code>`</code>json<br>{<br>  "status": "healthy",<br>  "timestamp": "2025-01-XX T XX:XX:XX.XXXZ",<br>  "services": {<br>    "database": "healthy",<br>    "blob_storage": "healthy",<br>    "search_index": "healthy"<br>  }<br>}<br><code>`</code></p><p>---</p><p><h2>Security</h2></p><p><h3>Authentication</h3><br><li>JWT tokens for API authentication</li><br><li>Session-based authentication for web interface</li><br><li>Token expiration and refresh mechanisms</li></p><p><h3>Authorization</h3><br><li>Role-based access control (RBAC)</li><br><li>Resource-level permissions</li><br><li>API rate limiting</li></p><p><h3>Data Protection</h3><br><li>HTTPS encryption for all communications</li><br><li>Data encryption at rest in Azure</li><br><li>Secure file upload validation</li><br><li>XSS and CSRF protection</li></p><p><h3>Security Headers</h3><br><code>`</code>http<br>X-Content-Type-Options: nosniff<br>X-Frame-Options: DENY<br>X-XSS-Protection: 1; mode=block<br>Strict-Transport-Security: max-age=31536000<br><code>`</code></p><p>---</p><p><h2>Troubleshooting</h2></p><p><h3>Common Issues</h3></p><p><h4>File Upload Failures</h4><br><code>`</code>bash<br><h1>Check Azure Storage connection</h1><br>az storage account show --name your-storage-account</p><p><h1>Verify container permissions</h1><br>az storage container show --name hr-ax-pro --account-name your-storage-account<br><code>`</code></p><p><h4>Search Index Issues</h4><br><code>`</code>bash<br><h1>Check search service status</h1><br>curl -H "api-key: YOUR_SEARCH_KEY" \<br>  "https://your-search-service.search.windows.net/indexes/documents/stats?api-version=2023-11-01"<br><code>`</code></p><p><h4>Database Connection Issues</h4><br><code>`</code>sql<br>-- Check Supabase connection<br>SELECT version();</p><p>-- Verify table structure<br>\d user_feedback;<br>\d admin_feedback;<br><code>`</code></p><p><h3>Performance Optimization</h3></p><p><h4>Frontend</h4><br><li>Enable code splitting</li><br><li>Implement lazy loading</li><br><li>Optimize bundle size</li><br><li>Use CDN for static assets</li></p><p><h4>Backend</h4><br><li>Implement caching strategies</li><br><li>Optimize database queries</li><br><li>Use connection pooling</li><br><li>Monitor memory usage</li></p><p><h4>Azure Services</h4><br><li>Optimize search index configuration</li><br><li>Implement blob storage tiering</li><br><li>Monitor service quotas</li><br><li>Set up auto-scaling</li></p><p><h3>Debugging Tools</h3><br><li>Browser Developer Tools</li><br><li>React Developer Tools</li><br><li>Azure Portal monitoring</li><br><li>Supabase dashboard</li><br><li>Application Insights</li></p><p>---</p><p><h2>API Testing</h2></p><p><h3>Using cURL</h3><br><code>`</code>bash<br><h1>Test file upload</h1><br>curl -X POST \<br>  -H "Authorization: Bearer YOUR_TOKEN" \<br>  -F "file=@document.pdf" \<br>  -F "op=blob_upload" \<br>  -F "name=document.pdf" \<br>  https://your-api-domain.com/rag-api</p><p><h1>Test search</h1><br>curl -X POST \<br>  -H "Authorization: Bearer YOUR_TOKEN" \<br>  -H "Content-Type: application/json" \<br>  -d '{"op":"search","q":"test query","top":10}' \<br>  https://your-api-domain.com/rag-api<br><code>`</code></p><p><h3>Using Postman</h3><br><li>Import the API collection</li><br><li>Set up environment variables</li><br><li>Configure authentication</li><br><li>Run test scenarios</li></p><p>---</p><p><h2>Maintenance</h2></p><p><h3>Regular Tasks</h3><br><li>Monitor disk usage in Azure Storage</li><br><li>Check search index health</li><br><li>Review error logs</li><br><li>Update dependencies</li><br><li>Backup database</li></p><p><h3>Backup Strategy</h3><br><li><strong>Database</strong>: Daily automated backups</li><br><li><strong>Files</strong>: Azure Storage redundancy</li><br><li><strong>Configuration</strong>: Version control</li><br><li><strong>Code</strong>: Git repository</li></p><p><h3>Update Procedures</h3><br><li>Test in staging environment</li><br><li>Create backup</li><br><li>Deploy to production</li><br><li>Monitor for issues</li><br><li>Rollback if necessary</li></p><p>---</p><p><em>This technical documentation is maintained by the development team. For updates or questions, contact the system administrators.</em><br></p>
</body>
</html>